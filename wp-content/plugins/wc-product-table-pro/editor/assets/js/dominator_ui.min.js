var dominator_ui={};jQuery((function($){dominator_ui={init:function($elm,data){"string"==typeof $elm&&($elm=$($elm));var _=this,$controllers=$elm.find("[wcpt-controller]").addBack(),$data_nodes=$elm.find("[wcpt-model-key]").addBack(),$value_forwards=$elm.find("[wcpt-value-forward]"),$content_templates=$elm.find("[wcpt-content-template]"),$row_wrapper=$elm.find("[wcpt-row-template]").parent(),$add_row=$elm.find("[wcpt-add-row-template]"),$duplicate_row=$elm.find("[wcpt-duplicate-row]"),$move_row_up=$elm.find("[wcpt-move-up]"),$move_row_down=$elm.find("[wcpt-move-down]"),$remove_row=$elm.find("[wcpt-remove-row]"),$panel_conditions=$elm.find("[wcpt-panel-condition]");if($elm.attr("wcpt-initial-data")){$.each(data,(function(key,val){null!==val&&"object"==typeof val&&-1==val.constructor.toString().indexOf("Array")&&jQuery.isEmptyObject(val)&&delete data[key]}));var initial_data=$.extend({},_.initial_data[$elm.attr("wcpt-initial-data")]);$.each(initial_data,(function(key,val){void 0!==data[key]&&delete initial_data[key]}));var data=$.extend(!0,{},initial_data,data)}$controllers.add($data_nodes).each((function(){var $child=$(this),$parent=$child.parent().closest("[wcpt-model-key]"),$children=$parent.data("wcpt-children");$children||($children=$()),$children=$children.add($child),$parent.data("wcpt-children",$children),$child.data("wcpt-parent",$parent)})),$value_forwards.each((function(){var $this=$(this),selector=$this.attr("wcpt-value-forward"),$data_node=$this.closest(selector);$this.data("wcpt-data-node",$data_node),$data_node.data("wcpt-value-forward",$this)})),$content_templates.each((function(){var $this=$(this),$data_node=$this.closest("[wcpt-model-key]");$this.data("wcpt-data-node",$data_node);var $content_templates=$data_node.data("wcpt-content-templates");$content_templates||($content_templates=$()),$content_templates=$content_templates.add($this),$data_node.data("wcpt-content-templates",$content_templates)})),$panel_conditions.each((function(){var $this=$(this),ancestor_skip=$this.attr("wcpt-panel-ancestor-skip"),$data_node=$this.parent().closest("[wcpt-model-key]");for(ancestor_skip||(ancestor_skip=0);ancestor_skip>0;)$data_node=$data_node.parent().closest("[wcpt-model-key]"),--ancestor_skip;$this.data("wcpt-parent",$data_node);var $panel_conditions=$data_node.data("wcpt-panel-conditions");$panel_conditions||($panel_conditions=$()),$panel_conditions=$panel_conditions.add($this),$data_node.data("wcpt-panel-conditions",$panel_conditions)})),$row_wrapper.each((function(){var $wrapper=$(this),connect_with=$wrapper.attr("wcpt-connect-with");$wrapper.hasClass("wcpt-sortable")&&$wrapper.sortable({handle:function(){return $wrapper.find(".wcpt-sortable-handle").first()},connectWith:connect_with,items:'>[wcpt-model-key="[]"]',update:function(e,ui){var $button=ui.item.siblings(".wcpt-button[wcpt-add-row-template]"),$last_row=ui.item.siblings().addBack().filter("[wcpt-row-template].wcpt-last-row");$button.length&&$last_row.length&&$button.index()<$last_row.index()&&$button.detach().insertAfter($last_row)}})})),$add_row.add($duplicate_row).add($remove_row).add($move_row_up).add($move_row_down).each((function(){var $this=$(this),$row=$this.closest("[wcpt-model-key]"),$rows_wrapper,rows_data=$row.data("wcpt-parent").data("wcpt-data");$this.data("wcpt-parent",$row)})),$remove_row.each((function(){var $this=$(this),$row=$this.data("wcpt-parent"),min_rows=$row.attr("wcpt-min-rows")?parseInt($row.attr("wcpt-min-rows")):0,$rows_wrapper,rows_data=$row.data("wcpt-parent").data("wcpt-data");min_rows&&void 0!==rows_data&&"[object Array]"==Object.prototype.toString.call(rows_data)&&(rows_data.length>min_rows?$this.removeAttr("wcpt-disabled"):$this.attr("wcpt-disabled",""))})),$elm.find("[wcpt-row-template]").each((function(){var $template=$(this),template_name=$template.attr("wcpt-row-template");_.row_templates[template_name]||(_.row_templates[template_name]=$template[0].outerHTML,$template.attr("wcpt-disabled",""))})),$controllers.add($data_nodes).each((function(){var $this,$children=$(this).data("wcpt-children"),fixed=[];$children&&$children.length&&$children.filter('[type="radio"]').each((function(){var $radio,model_key=$(this).attr("wcpt-model-key");if(-1===$.inArray(model_key,fixed)){fixed.push(model_key);var name="wcpt-"+model_key+"-"+Math.random(0,1e9);$children.filter('[type="radio"][wcpt-model-key="'+model_key+'"]').each((function(){var $sibling;$(this).attr("name",name)}))}}))})),$controllers.add($data_nodes).off("change keyup").on("change keyup",(function(e){var $this=$(this),key=$this.attr("wcpt-model-key"),index=$this.attr("wcpt-model-key-index"),$parent=$this.data("wcpt-parent"),val;if(val=-1!==$.inArray($this[0].tagName,["SELECT","INPUT","TEXTAREA"])?-1!==$.inArray($this[0].type,["checkbox"])?$this[0].checked:$this.val():$this.data("wcpt-data"),$parent&&$parent.length){var parent_data=$parent.data("wcpt-data");switch(key){case"[]":parent_data||(parent_data=[]),parent_data[index]=val;break;default:if(key.length>2&&"[]"==key.slice(-2)){var true_key=key.slice(0,-2),val=$this.val(),index;if(void 0!==parent_data[true_key]&&Array.isArray(parent_data[true_key])||(parent_data[true_key]=[]),$this.prop("checked"))-1===parent_data[true_key].indexOf(val)&&parent_data[true_key].push(val);else(index=parent_data[true_key].indexOf(val))>-1&&parent_data[true_key].splice(index,1)}else parent_data&&!Array.isArray(parent_data)||(parent_data={}),parent_data[key]=val}$parent.data("wcpt-data",parent_data)}var $content_templates=$this.data("wcpt-content-templates");$content_templates&&"object"==typeof val&&$content_templates.each((function(){var $content_template=$(this),_key=$content_template.attr("wcpt-content-template"),_val=val.hasOwnProperty(_key)?val[_key]:"",value_modifier=$content_template.attr("wcpt-value-modifier");"function"==typeof _.value_modifiers[value_modifier]&&(_val=_.value_modifiers[value_modifier](_val)),$content_template.text(_val)}));var $panel_conditions=$this.data("wcpt-panel-conditions"),$parent;if($panel_conditions){var condition_context=$this.data("wcpt-data");$panel_conditions.each((function(){var $this=$(this),condition_key=$this.attr("wcpt-panel-condition");if(_.panel_conditions[condition_key]($this,condition_context)){$this.removeAttr("wcpt-disabled");var enable_handler=$this.attr("wcpt-panel-enable");enable_handler&&_.panel_enable[enable_handler]($this)}else{$this.attr("wcpt-disabled","");var disable_handler=$this.attr("wcpt-panel-disable");disable_handler&&_.panel_disable[disable_handler]($this)}}))}if(($parent=$this.data("wcpt-parent"))&&$parent.length&&key&&"[]"!==key&&"[]"!==key.slice(-2))var parent_data=$parent.data("wcpt-data"),$siblings=$parent.data("wcpt-children");if($this.attr("wcpt-controller")){var controller_name=$this.attr("wcpt-controller");void 0!==_.controllers[controller_name]&&_.controllers[controller_name]($this,val,e)}})),$controllers.add($data_nodes).off("sortupdate").on("sortupdate",(function(e){var $wrapper=$(this),$target=$(e.target);$wrapper.is($target)&&void 0!==$wrapper.data("wcpt-children")&&_.reindex_rows($wrapper)})),$controllers.add($data_nodes).off("sortreceive").on("sortreceive",(function(e,ui){var $wrapper=$(this),$target=$(e.target);if($wrapper.is($target)&&void 0!==$wrapper.data("wcpt-children")){var $item=ui.item,wrapper_data=$wrapper.data("wcpt-data"),item_data=$item.data("wcpt-data"),index=$item.index();_.init($item,item_data),wrapper_data.splice(index,0,item_data),_.reindex_rows($wrapper)}})),$value_forwards.off("change").on("change",(function(){var $this=$(this),val=$this.val();$data_node=$this.data("wcpt-data-node"),$data_node.data("wcpt-data",val)})),$add_row.off("click").on("click",(function(){var $button=$(this),template_name=$button.attr("wcpt-add-row-template"),direction=$button.attr("wcpt-direction"),$template=$(_.row_templates[template_name]),$last_row=$button.prev("[wcpt-row-template]"),index=0;if($last_row.length&&$last_row.attr("wcpt-row-template")==template_name&&$last_row.attr("wcpt-model-key-index"))var index=parseInt($last_row.attr("wcpt-model-key-index"))+1;direction&&"before"!=direction?$template.insertAfter($button):$template.insertBefore($button),_.init($template,{});var $rows_wrapper=$button.data("wcpt-parent");_.reindex_rows($rows_wrapper),window.wcpt_feedback_anim("add_new_row",$template)})),$duplicate_row.off("click").on("click",(function(){var $this,$row=$(this).data("wcpt-parent"),row_data=$row.data("wcpt-data"),template_name=$row.attr("wcpt-row-template"),$template=$(_.row_templates[template_name]),index=parseInt($row.attr("wcpt-model-key-index"))+1;$template.insertAfter($row);var copy_row_data={};$.extend(!0,copy_row_data,row_data),_.init($template,_.refresh_ids(copy_row_data));var $rows_wrapper=$row.data("wcpt-parent");_.reindex_rows($rows_wrapper),$row.hasClass("wcpt-toggle-column-expand")?$template.addClass("wcpt-toggle-column-expand"):$template.removeClass("wcpt-toggle-column-expand"),window.wcpt_feedback_anim("duplicate_row",$template)})),$remove_row.off("click").on("click",(function(){var $this,$row=$(this).data("wcpt-parent"),$sibling_rows=$row.siblings("[wcpt-row-template]"),index=$row.attr("wcpt-model-key-index"),$rows_wrapper=$row.data("wcpt-parent");window.wcpt_feedback_anim("delete_row",$row),$row.remove(),_.reindex_rows($rows_wrapper)})),$move_row_up.off("click").on("click",(function(){var $this,$row=$(this).data("wcpt-parent"),$prev=$row.prev("[wcpt-row-template]"),$rows_wrapper=$row.data("wcpt-parent");$prev.length&&($row.insertBefore($prev),_.reindex_rows($rows_wrapper),wcpt_feedback_anim("move_row_up",$row))})),$move_row_down.off("click").on("click",(function(){var $this,$row=$(this).data("wcpt-parent"),$next=$row.next("[wcpt-row-template]"),$rows_wrapper=$row.data("wcpt-parent");$next.length&&($row.insertAfter($next),_.reindex_rows($rows_wrapper),wcpt_feedback_anim("move_row_down",$row))})),data&&_.set_data($elm,data)},set_data:function($elm,data){if($elm.data("wcpt-data",data),void 0===$elm.attr("wcpt-block-editor")){var _=this,$children=$elm.data("wcpt-children");$children&&$children.each((function(){var $this=$(this),key=$this.attr("wcpt-model-key");switch(key){case"[]":var template_name=$this.attr("wcpt-row-template"),$template=$(_.row_templates[template_name]);if($this.siblings('[wcpt-row-template="'+template_name+'"]').remove(),$this.replaceWith($template),$this=$template,void 0===data[0]){$this.remove();break}if(_.init($this,data[0]),$this.addClass("wcpt-first-row wcpt-last-row"),data.length>1){$this.removeClass("wcpt-last-row");for(var $current=$template,i=1;i<data.length;){var $new=$(_.row_templates[template_name]);$new.attr("wcpt-model-key-index",i),$current.after($new),$current=$new,_.init($current,data[i]),++i}$current.addClass("wcpt-last-row")}break;default:if(key.length>2&&"[]"==key.slice(-2)){var true_key=key.slice(0,-2),val=$this.val();if(void 0!==data[true_key]&&Array.isArray(data[true_key])||(data[true_key]=[]),$this.prop("checked",data[true_key].indexOf(val)>-1),$this.attr("wcpt-controller")){var controller_name=$this.attr("wcpt-controller");void 0!==_.controllers[controller_name]&&_.controllers[controller_name]($this)}}else void 0!==data[key]&&(-1!==$.inArray($this[0].tagName,["INPUT","SELECT","TEXTAREA"])&&("checkbox"==$this[0].type?data[key]?$this.prop("checked",!0):$this.prop("checked",!1):"radio"==$this[0].type?data[key]==$this.attr("value")?$this.prop("checked",!0):$this.prop("checked",!1):$this.val(data[key])),_.set_data($this,data[key]))}}));var $value_forward=$elm.data("wcpt-value-forward");$value_forward&&$value_forward.val(data);var $content_templates=$elm.data("wcpt-content-templates");$content_templates&&$content_templates.each((function(){var $content_template=$(this),key=$content_template.attr("wcpt-content-template"),val=$elm.data("wcpt-data")[key],modifier=$content_template.attr("wcpt-value-modifier");modifier&&(val=_.value_modifiers[modifier](val)),val=String(val).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),$content_template.text(val)}));var $panel_conditions=$elm.data("wcpt-panel-conditions");if($panel_conditions&&$panel_conditions.each((function(){var $this=$(this),condition_key=$this.attr("wcpt-panel-condition");_.panel_conditions[condition_key]($this,data)?$this.removeAttr("wcpt-disabled"):$this.attr("wcpt-disabled","")})),$elm.attr("wcpt-controller")){var controller_name=$elm.attr("wcpt-controller");void 0!==_.controllers[controller_name]&&_.controllers[controller_name]($elm,data)}}else $elm.wcpt_block_editor()},reindex_rows:function($wrapper){var $children=$wrapper.data("wcpt-children"),$removed=$(),wrapper_data=[];$children.each((function(){var $child=$(this),child_index=$wrapper.children('[wcpt-model-key="[]"]').index($child);child_data=$child.data("wcpt-data"),-1!==child_index?(wrapper_data[child_index]=child_data,$child.attr("wcpt-model-key-index",child_index)):$removed=$removed.add($child)})),$wrapper.data("wcpt-data",wrapper_data),$wrapper.data("wcpt-children",$children.not($removed)),$wrapper.data("wcpt-children").removeClass("wcpt-first-row wcpt-last-row"),$wrapper.data("wcpt-children").filter((function(){return 0==$(this).attr("wcpt-model-key-index")})).addClass("wcpt-first-row"),$wrapper.data("wcpt-children").filter((function(){return $(this).attr("wcpt-model-key-index")==$wrapper.data("wcpt-children").length-1})).addClass("wcpt-last-row"),$wrapper.change()},controllers:{column_row:function($elm,data,e){if("property"==data.type){var prop=data.property?data.property:$elm.data("wcpt-children").filter('[wcpt-model-key="property"]').val(),attrs="";$.each(data,(function(key,val){key.substring(0,prop.length)==prop&&(attrs+=" "+key.substring(prop.length+1)+'="'+val+'" ')})),data.content="["+prop+attrs+"]",$elm.data("wcpt-children").filter("[wcpt-model-key='template']").val(data.content)}else if("custom_field"==data.type){var key=data.custom_field?data.custom_field:"";data.content='[custom_field key="'+key+'"]',$elm.data("wcpt-children").filter("[wcpt-model-key='template']").val(data.content)}else if("attribute"==data.type){var name=data.attribute?data.attribute:"";data.content='[attribute name="'+name+'"]',$elm.data("wcpt-children").filter("[wcpt-model-key='template']").val(data.content)}else"buttons"==data.type&&(data.content="",data.buttons instanceof Array&&$.each(data.buttons,(function(index,button){var button_mkp="[button ";$.each(button,(function(button_key,button_val){button_mkp+=button_key+'="'+button_val+'" '})),button_mkp+="]",data.content+=button_mkp})),$elm.data("wcpt-children").filter("[wcpt-model-key='template']").val(data.content))},header_row:function($elm,data,e){$elm.removeClass("wcpt-editor-columns-enabled-left wcpt-editor-columns-enabled-left-right wcpt-editor-columns-enabled-left-center-right"),$elm.addClass("wcpt-editor-columns-enabled-"+data.columns_enabled)},filters:function($elm,data,e){data&&data.length?$elm.prev(".wcpt-filter-headings").show():$elm.prev(".wcpt-filter-headings").hide()}},row_templates:{},refresh_ids:function(item){var _=this;return $.each(item,(function(key,val){"object"==typeof val&&(item[key]=_.refresh_ids(val)),"id"==key&&(item[key]=Math.round(1e9*Math.random()))})),item},value_modifiers:{escape_html:function(val){return!!val&&val.replace(/[\u00A0-\u9999<>\&]/gim,(function(i){return"&#"+i.charCodeAt(0)+";"}))},unlsug_filter_options_source:function(val){var options;return{product_cat:"Categories",product_tag:"Product tags",product_name:"Product names",attribute:"Attribute",price:"Price",rating:"Rating",custom_field:"Custom field",in_stock:"In stock",on_sale:"On sale"}[val]},unlsug_filter_template:function(val){var options;return{dropdown:"Dropdown",checkbox:"Checkbox",radio:"Radio",search:"Search",min_max:"Min-max"}[val]}},initial_data:{column_row:{heading:"",template:"",orderby:"title"},header_row:{columns_enabled:"left-right",columns:{left:{template:""},center:{template:""},right:{template:""}}}},panel_conditions:{prop:function($elm,data){var prop=$elm.attr("wcpt-condition-prop"),val=$elm.attr("wcpt-condition-val"),_data=$.extend({},data);return"true"===val?!!_data[prop]:"false"===val?!_data[prop]:"!"===val.substr(0,1)?(val=val.substr(1))!=_data[prop]:void 0!==_data[prop]&&_data[prop].constructor===Array?-1!==$.inArray(val,_data[prop]):(vals_arr=val.split("||"),-1!==$.inArray(_data[prop],vals_arr))}},panel_enable:{custom_content:function($elm){$elm.find(".CodeMirror").each((function(){this.CodeMirror.refresh()}))}},panel_disable:{}},$(window).trigger("dominator_ui_ready")}));