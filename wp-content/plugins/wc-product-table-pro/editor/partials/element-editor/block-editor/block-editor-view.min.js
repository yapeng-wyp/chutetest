!function($,view){view.parent,view.render=function(){var $be=this.parent.$elm,parent=this.parent,view=this,data=this.parent.model.get_data();if($be.empty(),$.each(data,(function(index,row){var $row=$('<div class="wcpt-block-editor-row" data-id="'+row.id+'">').data("wcpt-data",row);$.each(row.elements,(function(el_index,element){var $element=$('<div class="wcpt-element-block" data-type="'+element.type+'" data-id="'+element.id+'">'+view.get_label(element)+"</div>");$row.append($element.data("wcpt-data",element))}));var $add_element=$('<a href="#" class="wcpt-block-editor-add-element">+ Add Element</a>');if($row.append($add_element),parent.config.edit_row_partial){var icon=$("#wcpt-icon-sliders").length?$("#wcpt-icon-sliders").text():"*",$settings=$('<span class="wcpt-block-editor-edit-row" title="Edit row settings">'+icon+"</span>");$row.append($settings)}if(parent.config.delete_row&&(data.length>1||void 0!==data[0].elements&&data[0].elements.length)){var icon=$("#wcpt-icon-x").length?$("#wcpt-icon-x").text():"x",$del=$('<span class="wcpt-block-editor-delete-row" title="Delete row">'+icon+"</span>");$row.append($del)}$be.append($row)})),this.parent.config.add_row){var $add_row=$('<a href="#" class="wcpt-block-editor-add-row">+ Add Row</a>');$be.append($add_row)}$(".wcpt-block-editor-row",$be).length>1?$be.sortable({items:".wcpt-block-editor-row",disabled:!1}):$be.sortable({items:".wcpt-block-editor-row",disabled:!0});var cw=this.parent.config.connect_with,$lb=$be.closest(".wcpt-block-editor-lightbox-screen");$lb.length&&(cw='[data-partial="'+$lb.attr("data-partial")+'"].wcpt-block-editor-lightbox-screen '+cw),$(".wcpt-block-editor-row",$be).sortable({items:".wcpt-element-block",connectWith:cw,placeholder:"wcpt-element-block-placeholder",forcePlaceholderSize:!0,start:function(event,ui){ui.helper.width(ui.helper.width()+1).height(""),ui.placeholder.width(ui.item.outerWidth()).addClass("wcpt-element-block")},sort:function(event,ui){var $target=$(event.target);if($target.closest(".wcpt-block-editor-lightbox-screen").length&&!/html|body/i.test($target.offsetParent()[0].tagName)){var top=event.pageY-$target.offsetParent().offset().top-1.5*ui.helper.outerHeight(!0);ui.helper.css({top:top+"px"})}}})},view.lightbox=function(options){var default_ops={$element:null,duplicate_remove:!0,attr:{}};$.extend(!0,default_ops,options);var $lightbox=$('<div class="wcpt-block-editor-lightbox-screen"><div class="wcpt-block-editor-lightbox-content"></div></div>'),$tray=$('<div class="wcpt-block-editor-lightbox-tray"></div>'),done_icon=$("#wcpt-icon-check").length?$("#wcpt-icon-check").text():"",$done=$('<span class="wcpt-block-editor-lightbox-done" title="Done">'+done_icon+"</span>"),close_icon=$("#wcpt-icon-x").length?$("#wcpt-icon-x").text():"",$close=$('<span class="wcpt-block-editor-lightbox-close" title="Close">'+close_icon+"</span>"),remove_icon=$("#wcpt-icon-trash").length?$("#wcpt-icon-trash").text():"",$remove=$('<span class="wcpt-block-editor-lightbox-remove" title="Trash">'+remove_icon+"</span>"),duplicate_icon=$("#wcpt-icon-copy").length?$("#wcpt-icon-copy").text():"",$duplicate=$('<span class="wcpt-block-editor-lightbox-duplicate" title="Clone">'+duplicate_icon+"</span>");options.duplicate_remove?($tray.append($done),$tray.append($duplicate.add($remove))):$tray.append($close),$("> .wcpt-block-editor-lightbox-content",$lightbox).append($tray),$("body").append($lightbox),$lightbox.data("wcpt-block-element",options.$element?options.$element:"").attr({"wcpt-controller":"edit-element-lightbox","wcpt-model-key":"block_element_data"}).attr(options.attr).children(".wcpt-block-editor-lightbox-content").append($('script[data-wcpt-partial="'+options.partial+'"]').text()).end().show(),$("body").addClass("wcpt-be-lightbox-on");var _=this;$lightbox.on("click",(function(e){$(e.target).is($lightbox)&&$lightbox.trigger("destroy")})),$("> .wcpt-block-editor-lightbox-content > .wcpt-block-editor-lightbox-tray > .wcpt-block-editor-lightbox-close, > .wcpt-block-editor-lightbox-content > .wcpt-block-editor-lightbox-tray > .wcpt-block-editor-lightbox-done",$lightbox).on("click",(function(){$lightbox.trigger("destroy")})),$lightbox.on("destroy",(function(){$lightbox.change(),$lightbox.remove(),$(".wcpt-block-editor-lightbox-screen").length||$("body").removeClass("wcpt-be-lightbox-on")}));var $list=$(".wcpt-block-editor-element-type-list",$lightbox),$search_input=$(".wcpt-block-editor-element-type-list__search__input",$list),$elm_button=$(".wcpt-block-editor-element-type",$list);return $search_input.on("keyup",(function(){var $this,val=$(this).val().trim();val?$elm_button.each((function(){var $this=$(this),label;-1==$this.text().toLowerCase().trim().indexOf(val)?$this.hide():$this.show()})):$elm_button.show()})),$search_input.focus(),$lightbox},view.get_label=function(element){var type_unslug,label=element.type.replace(/(_|^)([^_]?)/g,(function(_,prep,letter){return(prep&&" ")+letter.toUpperCase()}));switch(element.type){case"attribute":case"attribute_filter":element.attribute_name&&("_custom"==element.attribute_name&&element.custom_attribute_name?label=element.custom_attribute_name+" (custom)":(label=element.attribute_name,"object"==typeof window.wcpt_attributes&&$.each(window.wcpt_attributes,(function(key,val){val.attribute_name==element.attribute_name&&(label=val.attribute_label)}))),label="Attribute: <span>"+view.sanitize(label.charAt(0).toUpperCase()+label.substr(1))+"</span>");break;case"custom_field":case"custom_field_filter":element.field_name&&(label="Custom field: <span>"+view.sanitize(element.field_name)+"</span>");break;case"taxonomy":case"taxonomy_filter":element.taxonomy&&(label="Taxonomy: <span>"+view.sanitize(element.taxonomy)+"</span>");break;case"text":case"text__col":element.text?((label=view.sanitize(element.text)).length>30&&(label=label.substring(0,30)+"..."),label='Text: <span>"'+label+'"<span>'):label="Text";break;case"html":case"html__col":element.html?((label=view.sanitize(element.html)).length>20&&(label=label.substring(0,20)+"..."),label='HTML: <span>"'+label+'"<span>'):label="HTML";break;case"shortcode":if(element.shortcode){var shortcode=element.shortcode;shortcode.length>30&&(shortcode=shortcode.substring(0,30)+"..."),label="Shortcode: <span>"+view.sanitize(shortcode)+"</span>"}break;case"sku":label="SKU";break;case"download_csv":label="Download CSV";break;case"media_image":case"media_image__col":label="Media Image";break;case"product_id":label="Product ID";break;case"sorting":if(element.orderby){if(label="Sort by: <span>","meta_value_num"==element.orderby||"meta_value"==element.orderby)label+=" CF - "+element.meta_key;else if("id"==element.orderby)label+=" Product ID";else if("sku"==element.orderby)label+=" SKU as text";else if("sku_num"==element.orderby)label+=" SKU as integer";else if(-1!==$.inArray(element.orderby,["attribute","attribute_num"])&&element.orderby_attribute){var attribute_label=element.orderby_attribute;$.each(wcpt_attributes,(function(index,attribute){if("pa_"+attribute.attribute_name==element.orderby_attribute)return attribute_label=attribute.attribute_label,!1})),label+=" Attribute - "+view.sanitize(attribute_label)}else label+=element.orderby[0].toUpperCase()+element.orderby.substring(1);label+="</span>"}break;case"search":if(element.target&&Array.isArray(element.target)&&element.target.length){if(1==element.target.length){var field;"attribute"==(field=element.target[0])&&element.attributes&&element.attributes.length&&(field+=": "+element.attributes.join(", ")),"custom_field"==field&&element.custom_fields&&element.custom_fields.length&&(field+=": "+element.custom_fields.join(", "))}else{var mixed_fields=element.target.join(", ");mixed_fields.length>45&&(mixed_fields=mixed_fields.substring(0,45)+"...");var field="mixed "+element.target.length+" ("+mixed_fields+")"}(field=view.sanitize(field)).length>70&&(field=field.substring(0,70)+"..."),label="Search: <span>"+field+"</span>"}break;case"apply_reset":label="Apply / Reset";break;case"regular_price__on_sale":console.log("here"),label="Regular price";break;case"icon":case"icon__col":element.name&&(label='<img class="wcpt-icon-rep" src="'+wcpt_icons+element.name+'.svg">');break;case"dot":case"dot__col":label="â‹…";break;case"select_variation":if(label="Select variation",void 0===element.display_type||"radio_single"==element.display_type)if(element.variation_name){var name=view.sanitize(element.variation_name);label="Select variation: <span>"+name+"</span>"}else label="Select variation: <span>*Single variation*</span>";else"radio_multiple"==element.display_type?label="Select variation: <span>*Radio buttons*</span>":"dropdown"==element.display_type&&(label="Select variation: <span>*Dropdown*</span>")}if(2==element.type.split("__").length&&-1==$.inArray(element.type,["text__col","html__col","media_image__col","icon__col","dot__col"])){var string=element.type.split("__")[0];label=string.charAt(0).toUpperCase()+string.slice(1).replace("_"," ")}return label},view.mark_elm=function(row_index,elm_index){var $be,$row=this.parent.$elm.children(".wcpt-block-editor-row").eq(row_index),$target;if($row.length){var $elm=$row.children(".wcpt-element-block").eq(elm_index);$target=$elm.length?$elm:$row}$target.addClass("wcpt-be-mark"),setTimeout((function(){$target.removeClass("wcpt-be-mark")}),1250)},view.sanitize=function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}(jQuery,WCPT_Block_Editor.View);