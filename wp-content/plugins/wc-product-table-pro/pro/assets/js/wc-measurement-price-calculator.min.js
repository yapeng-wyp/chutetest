var wcpt_wc_mc_init_cart;jQuery(document).ready((function($){function getPricingRule(measurement,wc_price_calculator_params){var foundRule=null;return $.each(wc_price_calculator_params.pricing_rules,(function(index,rule){if(measurement>=parseFloat(rule.range_start)&&(""===rule.range_end||measurement<=rule.range_end))return foundRule=rule,!1})),foundRule}function number_format(number,decimals,dec_point,thousands_sep){number=(number+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+number)?+number:0,prec=isFinite(+decimals)?Math.abs(decimals):0,sep=void 0===thousands_sep?",":thousands_sep,dec=void 0===dec_point?".":dec_point,s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec),s=""+n,p=s.indexOf(".");if(p>-1){p+=prec,s=s.replace(".","");var leading_zeroes="";String.prototype.startsWith||(String.prototype.startsWith=function(searchString,position){return position=isNaN(parseInt(position))?0:position,this.indexOf(searchString,position)===position}),s.startsWith("0")&&(leading_zeroes=s.slice(0,s.length-parseFloat(s).toString().length));var original=s,round;if(s=s.slice(0,p),original.slice(p,p+1)>=5&&(s=parseFloat(s),s=leading_zeroes+(s=""+(s+=1))),s.length<p){var zeroes=p-s.length;s*=Math.pow(10,zeroes),s=Number(s,10)}else s=Number([s,".",s.slice(p)].join(""),10);return""+Math.round(s)/k}return n.toFixed(prec)};return(s=(prec?toFixedFix(n,prec):""+Math.round(n)).split("."))[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)),(s[1]||"").length<prec&&(s[1]=s[1]||"",s[1]+=new Array(prec-s[1].length+1).join("0")),s.join(dec)}function preg_quote(str,delimiter){return(str+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(delimiter||"")+"-]","g"),"\\$&")}function convertUnits(value,fromUnit,toUnit,wc_price_calculator_params){return void 0!==wc_price_calculator_params.unit_normalize_table[fromUnit]&&(void 0!==wc_price_calculator_params.unit_normalize_table[fromUnit].inverse&&wc_price_calculator_params.unit_normalize_table[fromUnit].inverse?value/=wc_price_calculator_params.unit_normalize_table[fromUnit].factor:value*=wc_price_calculator_params.unit_normalize_table[fromUnit].factor,fromUnit=wc_price_calculator_params.unit_normalize_table[fromUnit].unit),void 0!==wc_price_calculator_params.unit_conversion_table[fromUnit]&&void 0!==wc_price_calculator_params.unit_conversion_table[fromUnit][toUnit]&&(void 0!==wc_price_calculator_params.unit_conversion_table[fromUnit][toUnit].inverse&&wc_price_calculator_params.unit_conversion_table[fromUnit][toUnit].inverse?value/=wc_price_calculator_params.unit_conversion_table[fromUnit][toUnit].factor:value*=wc_price_calculator_params.unit_conversion_table[fromUnit][toUnit].factor),value}function convertToFloat(str){var matches;return(matches=str.match(/(\d+)\s+(\d+)\/(\d+)/))?0!==matches[3]?parseFloat(matches[1])+matches[2]/matches[3]:parseFloat(matches[1]):(matches=str.match(/(\d+)\/(\d+)/))?0!==matches[2]?matches[1]/matches[2]:0:""===str?0:parseFloat(str)}function standardizeInput(val,wc_price_calculator_params){var thousandSeparator=$.trim(wc_price_calculator_params.woocommerce_price_thousand_sep).toString(),decimalSeparator=$.trim(wc_price_calculator_params.woocommerce_price_decimal_sep).toString();return val&&null!==val?isNaN(val)||(val=val.toString()):val="",val.length>0&&(val=(val="."===thousandSeparator?val.replace(/\./g,""):val.replace(new RegExp(thousandSeparator,"g"),"")).replace(decimalSeparator,".")),val}function woocommerce_price(price,wc_price_calculator_params){var formatted_price="",num_decimals=wc_price_calculator_params.woocommerce_price_num_decimals,currency_pos=wc_price_calculator_params.woocommerce_currency_pos,currency_symbol=wc_price_calculator_params.woocommerce_currency_symbol;switch(price=number_format(price,num_decimals,wc_price_calculator_params.woocommerce_price_decimal_sep,wc_price_calculator_params.woocommerce_price_thousand_sep),"yes"===wc_price_calculator_params.woocommerce_price_trim_zeros&&num_decimals>0&&(price=woocommerce_trim_zeros(price,wc_price_calculator_params)),currency_pos){case"left":formatted_price='<span class="amount">'+currency_symbol+price+"</span>";break;case"right":formatted_price='<span class="amount">'+price+currency_symbol+"</span>";break;case"left_space":formatted_price='<span class="amount">'+currency_symbol+"&nbsp;"+price+"</span>";break;case"right_space":formatted_price='<span class="amount">'+price+"&nbsp;"+currency_symbol+"</span>"}return formatted_price}function woocommerce_trim_zeros(price,wc_price_calculator_params){return price.replace(new RegExp(preg_quote(wc_price_calculator_params.woocommerce_price_decimal_sep,"/")+"0+$"),"")}wcpt_wc_mc_init_cart=function(){if("undefined"!=typeof wcpt_wc_price_calculator_params){var $cart=$(this),product_id=$cart.closest("[data-wcpt-product-id]").attr("data-wcpt-product-id"),wc_price_calculator_params=wcpt_wc_price_calculator_params[product_id];if(void 0!==wc_price_calculator_params&&"pricing"===wc_price_calculator_params.calculator_type&&($cart.bind("wc-measurement-price-calculator-update",(function(){var totalMeasurement;if($(".amount_needed:input",$cart).each((function(index,el){el=$(el);var val=null,measurementValue=convertToFloat(val="number"===$(this).attr("type")?el.val():standardizeInput(el.val(),wc_price_calculator_params));el.trigger("wc-measurement-price-calculator-product-measurement-change",[measurementValue])})),$(".amount_needed:input",$cart).each((function(index,el){el=$(el);var val=null,measurementValue=convertToFloat(val="number"===$(this).attr("type")?el.val():standardizeInput(el.val(),wc_price_calculator_params));if(!measurementValue||measurementValue<0)return totalMeasurement=0,!1;if(measurementValue=convertUnits(measurementValue,el.data("unit"),el.data("common-unit"),wc_price_calculator_params),"area-linear"===wc_price_calculator_params.measurement_type)totalMeasurement?totalMeasurement+=2*measurementValue:totalMeasurement=2*measurementValue;else if("area-surface"===wc_price_calculator_params.measurement_type){if(!totalMeasurement){var length=standardizeInput($("#length_needed",$cart).val(),wc_price_calculator_params);length=convertUnits(convertToFloat(length),$("#length_needed",$cart).data("unit"),$("#length_needed",$cart).data("common-unit"),wc_price_calculator_params);var width=standardizeInput($("#width_needed",$cart).val(),wc_price_calculator_params);width=convertUnits(convertToFloat(width),$("#width_needed",$cart).data("unit"),$("#width_needed",$cart).data("common-unit"),wc_price_calculator_params);var height=standardizeInput($("#height_needed",$cart).val(),wc_price_calculator_params);return height=convertUnits(convertToFloat(height),$("#height_needed",$cart).data("unit"),$("#height_needed",$cart).data("common-unit"),wc_price_calculator_params),void(totalMeasurement=2*(length*width+width*height+length*height))}}else totalMeasurement?totalMeasurement*=measurementValue:totalMeasurement=measurementValue})),totalMeasurement=convertUnits(totalMeasurement,wc_price_calculator_params.product_total_measurement_common_unit,wc_price_calculator_params.product_price_unit,wc_price_calculator_params),wc_price_calculator_params.pricing_rules){var rule=getPricingRule(totalMeasurement,wc_price_calculator_params);rule?(wc_price_calculator_params.product_price=parseFloat(rule.price),$(".single_variation span.price",$cart).html(rule.price_html)):(wc_price_calculator_params.product_price="",$(".single_variation span.price",$cart).html(""))}$("#_measurement_needed",$cart).val(totalMeasurement),$("#_measurement_needed_unit",$cart).val(wc_price_calculator_params.product_price_unit);var price=0,price_overage=0,overage_percentage=parseFloat(wc_price_calculator_params.pricing_overage),$price=$(".product_price",$cart),$price_overage=$(".product_price_overage",$cart);totalMeasurement?(price=wc_price_calculator_params.product_price*totalMeasurement,wc_price_calculator_params.minimum_price>price&&(price=parseFloat(wc_price_calculator_params.minimum_price)),overage_percentage>0&&(price+=price_overage=price*overage_percentage,$price_overage.html(woocommerce_price(price_overage,wc_price_calculator_params))),$price.html(woocommerce_price(price,wc_price_calculator_params)).trigger("wc-measurement-price-calculator-product-price-change",[totalMeasurement,price])):($price.html("").trigger("wc-measurement-price-calculator-product-price-change"),overage_percentage>0&&$price_overage.html(""));var $measureTotalAmount=null;if($measureTotalAmount=$(".wc-measurement-price-calculator-total-amount",$cart)){var params=wc_price_calculator_params,totalAmount=convertUnits(totalMeasurement,params.product_price_unit,$measureTotalAmount.data("unit"),wc_price_calculator_params);totalAmount=parseFloat(totalMeasurement.toFixed(params.measurement_precision)),$measureTotalAmount.text(number_format(totalAmount,params.measurement_precision,params.woocommerce_price_decimal_sep,params.woocommerce_price_thousand_sep))}if("undefined"!=typeof woocommerce_addons_params&&$cart.find("#product-addons-total").length>0){var productPrice=""===price?0:price,$totals;$cart.find("#product-addons-total").data("price",productPrice.toFixed(2)),$cart.trigger("woocommerce-product-addons-update")}})),$cart.trigger("wc-measurement-price-calculator-update"),$(".amount_needed:input",$cart).on("keyup change mpc-change",(function(){var $cart;$(this).closest("form.cart").trigger("wc-measurement-price-calculator-update")})).first().trigger("mpc-change"),$(".single_variation, .single_variation_wrap",$cart).bind("show_variation",(function(event,variation){var price=parseFloat(variation.price),minimumPrice=parseFloat(variation.minimum_price);wc_price_calculator_params.product_price=price,wc_price_calculator_params.minimum_price=minimumPrice,$cart.trigger("wc-measurement-price-calculator-show-variation",variation),$cart.trigger("wc-measurement-price-calculator-update"),$(".variable_price_calculator",$cart).show()}))),void 0!==wc_price_calculator_params&&"quantity"===wc_price_calculator_params.calculator_type){$cart.bind("wc-measurement-price-calculator-quantity-changed",(function(event,quantity,updateAmountNeeded=!0){if(wc_price_calculator_params.product_measurement_value){var fieldsToUpdate=[];(fieldsToUpdate=$(updateAmountNeeded?".amount_needed, .amount_actual":".amount_actual",$cart)).each((function(index,el){if(el=$(el),!($(".amount_needed",$cart).length>1)){var rawAmount=convertUnits(wc_price_calculator_params.product_measurement_value,wc_price_calculator_params.product_measurement_unit,el.data("unit"),wc_price_calculator_params),amount=parseFloat((rawAmount*quantity).toFixed(2)),params=wc_price_calculator_params;el.is("input")?"number"!==el.attr("type")?el.val(number_format(amount,2,params.woocommerce_price_decimal_sep,params.woocommerce_price_thousand_sep)):el.val(amount):el.text(number_format(amount,2,params.woocommerce_price_decimal_sep,params.woocommerce_price_thousand_sep))}})),$(".total_price",$cart).html(woocommerce_price(quantity*wc_price_calculator_params.product_price,wc_price_calculator_params)).trigger("wc-measurement-price-calculator-quantity-total-price-change",[quantity,wc_price_calculator_params.product_price])}}));var show_warning=!1;$cart.bind("wc-measurement-price-calculator-update",(function(){var totalMeasurement;if(wc_price_calculator_params.product_measurement_value&&($("input.amount_needed",$cart).each((function(index,el){var val,measurementValue=convertToFloat(standardizeInput((el=$(el)).val(),wc_price_calculator_params));if(!measurementValue||measurementValue<0)return totalMeasurement=0,!1;measurementValue=convertUnits(measurementValue,el.data("unit"),el.data("common-unit"),wc_price_calculator_params),totalMeasurement?totalMeasurement*=measurementValue:totalMeasurement=measurementValue})),totalMeasurement)){var productMeasurement=convertUnits(wc_price_calculator_params.product_measurement_value,wc_price_calculator_params.product_measurement_unit,wc_price_calculator_params.product_total_measurement_common_unit,wc_price_calculator_params),quantity=Math.ceil((totalMeasurement/productMeasurement).toFixed(wc_price_calculator_params.measurement_precision));quantity<parseFloat(wc_price_calculator_params.quantity_range_min_value)&&(quantity=parseFloat(wc_price_calculator_params.quantity_range_min_value)),parseFloat(wc_price_calculator_params.quantity_range_max_value)&&quantity>parseFloat(wc_price_calculator_params.quantity_range_max_value)?(quantity=parseFloat(wc_price_calculator_params.quantity_range_max_value),show_warning=!0):show_warning=!1,$("input[name=quantity]",$cart).val(quantity),$(".amount_actual",$cart).each((function(index,el){el=$(el);var amount=convertUnits(wc_price_calculator_params.product_measurement_value,wc_price_calculator_params.product_measurement_unit,el.data("unit"),wc_price_calculator_params);amount=parseFloat((amount*quantity).toFixed(2)),el.is("input")?el.val(amount):el.text(amount)})),show_warning?($("#stock-discrepancy-warning",$cart).remove(),$cart.after('<p id="stock-discrepancy-warning" class="woocommerce-error">'+wc_price_calculator_params.stock_warning+"</p>")):$("#stock-discrepancy-warning",$cart).remove(),$(".total_price",$cart).html(woocommerce_price(quantity*wc_price_calculator_params.product_price,wc_price_calculator_params)).trigger("wc-measurement-price-calculator-total-price-change",[quantity,wc_price_calculator_params.product_price])}}));var $amount_needed_input=$(".amount_needed:input",$cart);$amount_needed_input.on("keyup change mpc-change",(function(){var $cart=$(this).closest("form.cart");$cart.trigger("wc-measurement-price-calculator-update"),update_cookie($cart)})),$amount_needed_input.on("blur mpc-change",(function(){var $cart=$(this).closest("form.cart"),quantity=$("input[name=quantity]").val();$cart.trigger("wc-measurement-price-calculator-quantity-changed",[quantity,!1])})),$amount_needed_input.trigger("mpc-change"),$("input[name=quantity]",$cart).on("change mpc-change",(function(evt){var $cart=$(this).closest("form.cart");$cart.trigger("wc-measurement-price-calculator-quantity-changed",[evt.target.value]),update_cookie($cart)})).trigger("change"),$(".single_variation, .single_variation_wrap",$cart).bind("show_variation",(function(event,variation){wc_price_calculator_params.product_price=parseFloat(variation.price),wc_price_calculator_params.product_measurement_value=parseFloat(variation.product_measurement_value),wc_price_calculator_params.product_measurement_unit=variation.product_measurement_unit,variation.product_measurement_value?($("input.amount_needed",$cart).length>0&&$("input.amount_needed",$cart).val()?$cart.trigger("wc-measurement-price-calculator-update"):$cart.trigger("wc-measurement-price-calculator-quantity-changed",[$("input[name=quantity]",$cart).val()]),$(".variable_price_calculator",$cart).show()):$(".variable_price_calculator",$cart).hide()}))}}}}));