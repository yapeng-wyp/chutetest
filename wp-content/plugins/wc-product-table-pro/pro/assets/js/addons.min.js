jQuery((function($){wcPaoInitAddonTotals={isGroupedMixedProductType:function(){var group=$(".product-type-grouped"),subs=0,simple=0;return!!(group.length&&(group.find(".group_table tr.product").each((function(){0<$(this).find(".input-text.qty").val()&&($(this).find(".entry-summary .subscription-details").length?subs++:simple++)})),0<subs&&0<simple))},escapeHtml:function(html){return document.createElement("div").appendChild(document.createTextNode(html)).parentNode.innerHTML},isGroupedSubsSelected:function(){var group=$(".product-type-grouped"),subs=!1;return group.length&&group.find(".group_table tr.product").each((function(){if(0<$(this).find(".input-text.qty").val()&&$(this).find(".entry-summary .subscription-details").length)return subs=!0,!1})),subs},formatMoney:function(amount){return accounting.formatMoney(amount,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.trim_trailing_zeros?0:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format})},getCostByTax:function(addonCostRaw,addonCost){var cost;return cost=woocommerce_addons_params.price_include_tax&&woocommerce_addons_params.display_include_tax?addonCostRaw:woocommerce_addons_params.price_include_tax&&!woocommerce_addons_params.display_include_tax?addonCost:!woocommerce_addons_params.price_include_tax&&woocommerce_addons_params.display_include_tax?addonCost:woocommerce_addons_params.price_include_tax||woocommerce_addons_params.display_include_tax?addonCost:addonCostRaw},init:function(cart){$(cart).filter(".wcpt-product-form .cart, .wcpt-add-to-cart-wrapper .cart").find(".wc-pao-addon-checkbox-group-required").each((function(){var checkboxesGroup=this;$(this).find(".wc-pao-addon-checkbox").each((function(){$(this).bind("invalid",(function(e){$(checkboxesGroup).addClass("wc-pao-addon-checkbox-required-error"),e.preventDefault()}))})),$(this).find(".wc-pao-addon-checkbox").change((function(){$(checkboxesGroup).removeClass("wc-pao-addon-checkbox-required-error"),$(checkboxesGroup).find("input:checked").length>0?$(checkboxesGroup).find("input").each((function(){$(this).attr("required",!1)})):$(checkboxesGroup).find("input").each((function(){$(this).attr("required",!0)}))}))}));var $cart=cart,$variation_input=!!$cart.hasClass("variations_form")&&$cart.find('input[name="variation_id"], input.variation_id');$cart.on("click",".reset_variations",(function(){$.each($cart.find(".product-addon"),(function(){var element=$(this).find(".addon");(element.is(":checkbox")||element.is(":radio"))&&element.prop("checked",!1),element.is("select")&&element.prop("selectedIndex",0),(element.is(":text")||element.is("textarea")||element.is('input[type="number"]')||element.is('input[type="file"]'))&&element.val("")})),$cart.trigger("woocommerce-product-addons-update")})).on("mouseup","input[type=number]",(function(){$(this).trigger("woocommerce-product-addons-update")})).on("keyup change",".wc-pao-addon input, .wc-pao-addon textarea",(function(){if($(this).attr("maxlength")>0){var value=$(this).val(),remaining=$(this).attr("maxlength")-value.length;$(this).next(".wc-pao-addon-chars-remaining").find("span").text(remaining)}})).on("keyup",".wc-pao-addon-custom-textarea, .wc-pao-addon-custom-text, .wc-pao-addon-custom-price",(function(){$(this).trigger("woocommerce-product-addons-update")})).on("change",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, input.qty",(function(){$(this).trigger("woocommerce-product-addons-update")})).on("found_variation",(function(event,variation){var $variation_form=$(this),$totals=$variation_form.find("#product-addons-total");if(void 0!==variation.display_price)$totals.data("price",variation.display_price);else if($(variation.price_html).find(".amount:last").length){var product_price=$(variation.price_html).find(".amount:last").text();product_price=(product_price=(product_price=(product_price=product_price.replace(woocommerce_addons_params.currency_format_symbol,"")).replace(woocommerce_addons_params.currency_format_thousand_sep,"")).replace(woocommerce_addons_params.currency_format_decimal_sep,".")).replace(/[^0-9\.]/g,""),product_price=parseFloat(product_price),$totals.data("price",product_price)}$variation_form.trigger("woocommerce-product-addons-update")})).on("woocommerce-product-addons-update",(function(){var total=0,total_raw=0,$totals=$cart.find("#product-addons-total"),is_variable=$variation_input&&$variation_input.length>0,$subscription_plans=$cart.find(".wcsatt-options-product"),has_subscription_plans=$subscription_plans.length>0;if(product_id=is_variable?$variation_input.val():$totals.data("product-id"),product_price=$totals.data("price"),product_type=$totals.data("type"),qty=parseFloat($cart.find("input.qty").val()),addons=[],""===product_price&&"undefined"!=typeof custom_gift_card_amount&&custom_gift_card_amount.length&&0<custom_gift_card_amount.val()&&(product_price=custom_gift_card_amount.val()),woocommerce_addons_params.is_bookings&&$(".wc-bookings-booking-cost").length&&(product_price=parseFloat($(".wc-bookings-booking-cost").attr("data-raw-price"))),$cart.find(".wc-pao-addon-field").each((function(){var $addon=$(this),parentContainer=$addon.parents(".wc-pao-addon"),name=parentContainer.find(".wc-pao-addon-name").length?parentContainer.find(".wc-pao-addon-name").data("addon-name"):"",value_label="",addon_cost=0,addon_cost_raw=0,price_type=$addon.data("price-type"),is_custom_price=!1,addon_data={},has_per_person_pricing=!!parentContainer.find(".wc-pao-addon-name").length&&parentContainer.find(".wc-pao-addon-name").data("has-per-person-pricing"),has_per_block_pricing=!!parentContainer.find(".wc-pao-addon-name").length&&parentContainer.find(".wc-pao-addon-name").data("has-per-block-pricing");if($addon.is(".wc-pao-addon-custom-price")){if(!$addon.val())return;is_custom_price=!0,addon_cost=$addon.val(),addon_cost_raw=$addon.val(),price_type="quantity_based"}else if($addon.is(".wc-pao-addon-input-multiplier")){if(isNaN($addon.val())||""===$addon.val()?($addon.val(""),$addon.closest("p").find(".wc-pao-addon-alert").show()):(""!==$addon.val()&&$addon.val(Math.ceil($addon.val())),$addon.closest("p").find(".wc-pao-addon-alert").hide()),!$addon.val())return;addon_cost=$addon.data("price")*$addon.val(),addon_cost_raw=$addon.data("raw-price")*$addon.val()}else if($addon.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")){if(!$addon.is(":checked"))return;value_label=$addon.data("label"),addon_cost=$addon.data("price"),addon_cost_raw=$addon.data("raw-price")}else if($addon.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")){if(!$addon.find("option:selected")||""===$addon.find("option:selected").val())return;price_type=$addon.find("option:selected").data("price-type"),$addon.val()&&(value_label=$addon.find("option:selected").data("label"),addon_cost=$addon.find("option:selected").data("price"),addon_cost_raw=$addon.find("option:selected").data("raw-price"))}else{if(!$addon.val())return;addon_cost=$addon.data("price"),addon_cost_raw=$addon.data("raw-price")}if(addon_cost||(addon_cost=0),addon_cost_raw||(addon_cost_raw=0),("booking"===product_type||"accommodation-booking"===product_type)&&woocommerce_addons_params.is_bookings){qty=0;var block_qty=0;void 0!==$("#wc_bookings_field_duration")&&0<$("#wc_bookings_field_duration").val()&&(block_qty=$("#wc_bookings_field_duration").val()),void 0!==$("#wc-bookings-form-end-time")&&0<$("#wc-bookings-form-end-time").val()&&(block_qty=$("#wc-bookings-form-end-time").val());var single_persons_input=$("#wc_bookings_field_persons"),person_qty=0;1===single_persons_input.length?person_qty=parseInt(person_qty,10)+parseInt(single_persons_input.val(),10):$(".wc-bookings-booking-form").find("input").each((function(){var field=this.id.match(/wc_bookings_field_persons_(\d+)/);null!=field&&$("#"+field[0]).length&&(person_qty=parseInt(person_qty,10)+parseInt($("#"+field[0]).val(),10))})),0===qty&&$(".wc-bookings-booking-cost").length&&(qty=1),has_per_person_pricing&&person_qty&&(qty*=person_qty),has_per_block_pricing&&block_qty&&(qty*=block_qty)}switch(price_type){case"flat_fee":addon_data.cost=parseFloat(addon_cost),addon_data.cost_raw=parseFloat(addon_cost_raw);break;case"quantity_based":addon_data.cost_pu=parseFloat(addon_cost),addon_data.cost_raw_pu=parseFloat(addon_cost_raw),addon_data.cost=addon_data.cost_pu*qty,addon_data.cost_raw=addon_data.cost_raw_pu*qty;break;case"percentage_based":addon_data.cost_pct=parseFloat(addon_cost)/100,addon_data.cost_raw_pct=parseFloat(addon_cost_raw)/100,addon_data.cost=parseFloat(product_price)*addon_data.cost_pct*qty,addon_data.cost_raw=parseFloat(product_price)*addon_data.cost_raw_pct*qty}if(total+=addon_data.cost||0,total_raw+=addon_data.cost_raw||0,void 0!==value_label){if("number"==typeof value_label||value_label.length)addon_data.name=name+(value_label?" - "+value_label:"");else{var userInput=$addon.val(),trimCharacters=parseInt(woocommerce_addons_params.trim_user_input_characters,10);$addon.is(".wc-pao-addon-file-upload")&&(userInput=userInput.replace(/^.*[\\\/]/,"")),trimCharacters<userInput.length&&(userInput=userInput.slice(0,trimCharacters)+"..."),addon_data.name=name+" - "+wcPaoInitAddonTotals.escapeHtml(userInput)}addon_data.is_custom_price=is_custom_price,addon_data.price_type=price_type,addons.push(addon_data)}})),$totals.data("price_data",addons),qty){var product_total_price,formatted_sub_total,$subscription_details,subscription_details_html,formatted_addon_total=wcPaoInitAddonTotals.formatMoney(total);if("undefined"!=typeof product_price&&product_id&&(product_total_price=$(".wc-bookings-booking-form").length?isNaN(product_price)?0:parseFloat(product_price):parseFloat(product_price*qty),formatted_sub_total=wcPaoInitAddonTotals.formatMoney(product_total_price+total)),has_subscription_plans){var satt=$cart.data("satt_script");if(satt&&satt.schemes_model.get_active_scheme_key()){var $selected_plan=$subscription_plans.find("input:checked");$selected_plan.val()&&($subscription_details=$selected_plan.parent().find(".subscription-details"))}}else $cart.parent().find(".subscription-details").length&&($cart.hasClass("bundle_data")||($subscription_details=$cart.parent().find(".subscription-details"),$variation_input&&$variation_input.length>0&&($subscription_details=$cart.parent().find(".woocommerce-variation .subscription-details"))));if($subscription_details&&$subscription_details.length>0&&(subscription_details_html=" "+$subscription_details.clone().wrap("<p>").parent().html()),"grouped"===product_type?subscription_details_html&&!isGroupedMixedProductType()&&isGroupedSubsSelected()&&(formatted_addon_total+=subscription_details_html,formatted_sub_total&&(formatted_sub_total+=subscription_details_html)):subscription_details_html&&formatted_sub_total&&(formatted_sub_total+=subscription_details_html),formatted_sub_total&&"1"==$totals.data("show-sub-total")){var productName=$(this).closest(".wcpt-product-form").find(".wcpt-product-form-title").clone().find(".wcpt-product-form-price").remove().end().text(),productPrice=wcPaoInitAddonTotals.formatMoney(product_total_price);if($(".wc-bookings-booking-form").length)var html='<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>'+productName+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+productPrice+"</span></strong></div></li>";else var quantityString,html='<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>'+(is_rtl()?woocommerce_addons_params.quantity_symbol+qty:qty+woocommerce_addons_params.quantity_symbol)+"</span> "+productName+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+productPrice+"</span></strong></div></li>";addons.length&&($.each(addons,(function(i,addon){if("quantity_based"===addon.price_type){var cost=wcPaoInitAddonTotals.getCostByTax(addon.cost_raw,addon.cost),formattedValue=0===cost?"-":wcPaoInitAddonTotals.formatMoney(cost);html=html+'<li class="wc-pao-row-quantity-based"><div class="wc-pao-col1">'+addon.name+'</div><div class="wc-pao-col2"><span class="amount">'+formattedValue+"</span></div></li>"}})),$.each(addons,(function(i,addon){if("quantity_based"!==addon.price_type){if("percentage_based"!==addon.price_type)var cost=wcPaoInitAddonTotals.getCostByTax(addon.cost_raw,addon.cost);else var cost=addon.cost_raw;var formattedValue=0===cost?"-":'<span class="amount">'+wcPaoInitAddonTotals.formatMoney(cost)+"</span>";html=html+'<li><div class="wc-pao-col1"><strong>'+addon.name+'</strong></div><div class="wc-pao-col2">'+formattedValue+"</div></li>"}})));var price_display_suffix="",sub_total_string=void 0===$totals.data("i18n_sub_total")?woocommerce_addons_params.i18n_sub_total:$totals.data("i18n_sub_total");if(!woocommerce_addons_params.price_display_suffix||!woocommerce_addons_params.tax_enabled)return html=html+'<li class="wc-pao-subtotal-line"><p class="price">'+sub_total_string+' <span class="amount">'+formatted_sub_total+"</span></p></li></ul></div>",$totals.html(html),void $cart.trigger("updated_addons");if(!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")>-1&&!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1)return html=html+'<li class="wc-pao-subtotal-line"><strong>'+sub_total_string+' <span class="amount">'+formatted_sub_total+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></li></ul></div>",$totals.html(html),void $cart.trigger("updated_addons");$.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",product_id:product_id,add_on_total:total,add_on_total_raw:total_raw,qty:qty},success:function(result){if("SUCCESS"==result.result){price_display_suffix='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>";var formatted_price_including_tax='<span class="amount">'+wcPaoInitAddonTotals.formatMoney(result.price_including_tax)+"</span>",formatted_price_excluding_tax='<span class="amount">'+wcPaoInitAddonTotals.formatMoney(result.price_excluding_tax)+"</span>";price_display_suffix=(price_display_suffix=price_display_suffix.replace("{price_including_tax}",formatted_price_including_tax)).replace("{price_excluding_tax}",formatted_price_excluding_tax),html=html+'<li class="wc-pao-subtotal-line"><p class="price">'+sub_total_string+' <span class="amount">'+formatted_sub_total+"</span> "+price_display_suffix+" </p></li></ul></div>",$totals.html(html),$cart.trigger("updated_addons")}else html=html+'<li class="wc-pao-subtotal-line"><p class="price">'+sub_total_string+' <span class="amount">'+formatted_sub_total+"</span></p></li></ul></div>",$totals.html(html),$cart.trigger("updated_addons")},error:function(){html=html+'<li class="wc-pao-subtotal-line"><p class="price">'+sub_total_string+' <span class="amount">'+formatted_sub_total+"</span></p></li></ul></div>",$totals.html(html),$cart.trigger("updated_addons")}})}else $totals.empty(),$cart.trigger("updated_addons")}else $totals.empty(),$cart.trigger("updated_addons")})).on("click touchend",".wc-pao-addon-image-swatch",(function(e){e.preventDefault();var selectedValue=$(this).data("value"),parent=$(this).parents(".wc-pao-addon-wrap"),label=$.parseHTML($(this).data("price"));parent.prevAll("label").find(".wc-pao-addon-image-swatch-price").remove(),parent.find(".wc-pao-addon-image-swatch").removeClass("selected"),$(this).addClass("selected"),parent.find(".wc-pao-addon-image-swatch-select").val(selectedValue),parent.prevAll("label").append($(label)),$cart.trigger("woocommerce-product-addons-update")})),$cart.find(" .wc-pao-addon-custom-text, .wc-pao-addon-custom-textarea").each((function(){$(this).attr("maxlength")>0&&$(this).after('<small class="wc-pao-addon-chars-remaining">'+woocommerce_addons_params.i18n_remaining+"</small>")})),$("#credit_called").on("keyup",(function(){$cart.trigger("woocommerce-product-addons-update")})),$cart.find(".wc-pao-addon-custom, .wc-pao-addon-custom-textarea, .wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, input.qty, .variations select").change(),$(".wc-pao-addon-image-swatch").tipTip({delay:200})}};var is_rtl=function(){return"rtl"===document.documentElement.dir};$("body").on("quick-view-displayed",(function(){$(this).find(".cart:not(.cart_group)").each((function(){wcPaoInitAddonTotals.init($(this))}))})),$("body .component").on("wc-composite-component-loaded",(function(){$(this).find(".cart").each((function(){wcPaoInitAddonTotals.init($(this))}))})),$("body").find(".cart:not(.cart_group)").each((function(){wcPaoInitAddonTotals.init($(this))})),$("body").find(".wc-pao-addon-checkbox-group-required").each((function(){var checkboxesGroup=this;$(this).find(".wc-pao-addon-checkbox").each((function(){$(this).bind("invalid",(function(e){$(checkboxesGroup).addClass("wc-pao-addon-checkbox-required-error"),e.preventDefault()}))})),$(this).find(".wc-pao-addon-checkbox").change((function(){$(checkboxesGroup).removeClass("wc-pao-addon-checkbox-required-error"),$(checkboxesGroup).find("input:checked").length>0?$(checkboxesGroup).find("input").each((function(){$(this).attr("required",!1)})):$(checkboxesGroup).find("input").each((function(){$(this).attr("required",!0)}))}))}))}));