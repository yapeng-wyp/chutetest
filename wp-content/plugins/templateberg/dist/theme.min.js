!function(c){function s(t,s){let a=window.location.href,e=new RegExp("[?|&]"+t+"=[0-9a-zA-Z_+-|.,;]*");if(e.test(a)){let e=new RegExp("[?&]"+t+"=([^&#]*)");var l=e.exec(a)[0].charAt(0);a=a.replace(e,l+t+"="+s)}else{t=t+"="+s;a.indexOf("?")||(a+="?"),-1<a.indexOf("#")?(s=a.split("#"),a=s[0]+"&"+t+(s[1]?"#"+s[1]:"")):a+="&"+t}window.history.pushState(null,document.title,a)}class t{constructor(){this.state={tab:"all",isLoaded:!1,isError:!1,isMissing:!1,isAllCatSelected:!1,isFreeCatSelected:!1,isProCatSelected:!1,selectedCategory:"all",search:"",allThemeCats:[],allThemeFreeCats:[],allThemeProCats:[],normalThemeCats:[],normalThemeFreeCats:[],normalThemeProCats:[],gutenbergThemeCats:[],gutenbergThemeFreeCats:[],gutenbergThemeProCats:[],fseThemeCats:[],fseThemeFreeCats:[],fseThemeProCats:[],elementorThemeCats:[],elementorThemeFreeCats:[],elementorThemeProCats:[],data:[],countItems:[],countFreeItems:[],countProItems:[],sort:""}}toTitleCase(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}setState(e){let s=this;c.each(e,function(e,t){s.state[e]=t})}mobileMenu(){c(document).on("click",".tb-list__btn",function(){c(window).width()<767&&(c(".tb-list__template").toggleClass("tb-show-cat-sidebar"),c("body").toggleClass("tb-overflow"))}),c(window).on("resize",function(){767<c(this).width()&&(c(".tb-list__template").hasClass("tb-show-cat-sidebar")&&c(".tb-list__template").removeClass("tb-show-cat-sidebar"),c("body").hasClass("tb-overflow")&&c("body").removeClass("tb-overflow"))})}fixTab(e){return"all"}templateFetch(t=!1,e){let s;if(s=e||("popularity"===t?templateberg_all_theme.popularThemes:templateberg_all_theme.allThemes),Array.isArray(s)){let a=[],l=[],i=[],r=[],n=[],o=[],c=[],_=[],m=[],d=[],h=[],p=[],b=[],u=[],v=[],f=[],g=[],C=[],e=[];function w(e,t,s=!1){void 0===f[e]&&(f[e]=[]),s?void 0===f[e].all?f[e].all=1:f[e].all++:void 0===f[e][t]?f[e][t]=1:f[e][t]++}function T(e,t,s=!1){void 0===C[e]&&(C[e]=[]),s?void 0===C[e]["all-pro"]?C[e]["all-pro"]=1:C[e]["all-pro"]++:void 0===C[e][t]?C[e][t]=1:C[e][t]++}function y(e,t,s=!1){void 0===g[e]&&(g[e]=[]),s?void 0===g[e]["all-free"]?g[e]["all-free"]=1:g[e]["all-free"]++:void 0===g[e][t]?g[e][t]=1:g[e][t]++}s.map(t=>{let s=t.type;void 0===e[s]&&(e[s]=[]),e[s].push(t),void 0===e.all&&(e.all=[]),e.all.push(t),w(s,"",!0),(t.is_pro?T:y)(s,"",!0),w("all","",!0),(t.is_pro?T:y)("all","",!0),t.categories&&(t.categories.map(e=>{t.is_pro?(i.push(e),T("all",e)):(l.push(e),y("all",e)),a.push(e),w("all",e)}),"normal"===s?t.categories.map(e=>{t.is_pro?(o.push(e),T(s,e)):(n.push(e),y(s,e)),r.push(e),w(s,e)}):"gutenberg"===s?t.categories.map(e=>{t.is_pro?(m.push(e),T(s,e)):(_.push(e),y(s,e)),c.push(e),w(s,e)}):"full-site-editing"===s?t.categories.map(e=>{t.is_pro?(p.push(e),T(s,e)):(h.push(e),y(s,e)),d.push(e),w(s,e)}):"elementor"===s&&t.categories.map(e=>{t.is_pro?(v.push(e),T(s,e)):(u.push(e),y(s,e)),b.push(e),w(s,e)}))}),a=a.filter((e,t,s)=>s.indexOf(e)===t).sort(),l=l.filter((e,t,s)=>s.indexOf(e)===t).sort(),i=i.filter((e,t,s)=>s.indexOf(e)===t).sort(),r=r.filter((e,t,s)=>s.indexOf(e)===t).sort(),n=n.filter((e,t,s)=>s.indexOf(e)===t).sort(),o=o.filter((e,t,s)=>s.indexOf(e)===t).sort(),c=c.filter((e,t,s)=>s.indexOf(e)===t).sort(),_=_.filter((e,t,s)=>s.indexOf(e)===t).sort(),m=m.filter((e,t,s)=>s.indexOf(e)===t).sort(),d=d.filter((e,t,s)=>s.indexOf(e)===t).sort(),h=h.filter((e,t,s)=>s.indexOf(e)===t).sort(),p=p.filter((e,t,s)=>s.indexOf(e)===t).sort(),b=b.filter((e,t,s)=>s.indexOf(e)===t).sort(),u=u.filter((e,t,s)=>s.indexOf(e)===t).sort(),v=v.filter((e,t,s)=>s.indexOf(e)===t).sort();t=this.fixTab(e);this.setState({allThemeCats:a,allThemeFreeCats:l,allThemeProCats:i,normalThemeCats:r,normalThemeFreeCats:n,normalThemeProCats:o,gutenbergThemeCats:c,gutenbergThemeFreeCats:_,gutenbergThemeProCats:m,fseThemeCats:d,fseThemeFreeCats:h,fseThemeProCats:p,elementorThemeCats:b,elementorThemeFreeCats:u,elementorThemeProCats:v,data:e,isLoaded:!0,countItems:f,countFreeItems:g,countProItems:C,tab:t})}else this.setState({isLoaded:!0,isError:!0})}getCategories(){let t=this,e,s;return"all"===this.state.tab&&(s=this.state.allThemeCats),"normal"===this.state.tab?s=this.state.normalThemeCats:"gutenberg"===this.state.tab?s=this.state.gutenbergThemeCats:"full-site-editing"===this.state.tab?s=this.state.fseThemeCats:"elementor"===this.state.tab&&(s=this.state.elementorThemeCats),!!s&&(!!t.state.countItems[this.state.tab]&&(!!(e=s.map(e=>({label:t.toTitleCase(e),value:e,count:t.state.countItems[this.state.tab][e]})))&&[{label:templateberg_all_theme.text.allItems,value:"all",count:t.state.countItems[this.state.tab].all},...e]))}getFreeCategories(){let t=this,e,s;return"all"===this.state.tab?s=this.state.allThemeFreeCats:"normal"===this.state.tab?s=this.state.normalThemeFreeCats:"gutenberg"===this.state.tab?s=this.state.gutenbergThemeFreeCats:"full-site-editing"===this.state.tab?s=this.state.fseThemeFreeCats:"elementor"===this.state.tab&&(s=this.state.elementorThemeFreeCats),!!s&&(!!t.state.countFreeItems[this.state.tab]&&(!!(e=s.map(e=>({label:t.toTitleCase(e),value:e,count:t.state.countFreeItems[this.state.tab][e]})))&&[{label:templateberg_all_theme.text.allItems,value:"all-free",count:t.state.countFreeItems[this.state.tab]["all-free"]},...e]))}getProCategories(){let t=this,e,s;return"all"===this.state.tab?s=this.state.allThemeProCats:"normal"===this.state.tab?s=this.state.normalThemeProCats:"gutenberg"===this.state.tab?s=this.state.gutenbergThemeProCats:"full-site-editing"===this.state.tab?s=this.state.fseThemeProCats:"elementor"===this.state.tab&&(s=this.state.elementorThemeProCats),!!s&&(!!t.state.countProItems[this.state.tab]&&(!!(e=s.map(e=>({label:t.toTitleCase(e),value:e,count:t.state.countProItems[this.state.tab][e]})))&&[{label:templateberg_all_theme.text.allItems,value:"all-pro",count:t.state.countProItems[this.state.tab]["all-pro"]},...e]))}renderCategories(){let e=this,s="",a="",l="";const i=e=>"all"===e?"tb-list__current_item":"";e.getCategories()&&e.getCategories().map(e=>{var t=(t='<li class="'+i(e.value)+'">')+'<a href="#" data-cat="'+e.value+'">'+e.label.replace("-"," ")+"<span>"+e.count+"</span></a>";t+="</li>",s+=t}),e.getFreeCategories()&&e.getFreeCategories().map(e=>{var t=(t='<li class="'+i(e.value)+'">')+'<a href="#" data-cat="'+e.value+'">'+e.label.replace("-"," ")+"<span>"+e.count+"</span></a>";t+="</li>",a+=t}),e.getProCategories()&&e.getProCategories().map(e=>{var t=(t='<li class="'+i(e.value)+'">')+'<a href="#" data-cat="'+e.value+'">'+e.label.replace("-"," ")+"<span>"+e.count+"</span></a>";t+="</li>",l+=t}),c(".tb-list__cat_lists").html(s),c(".tb-cat-lists-free").html(a),c(".tb-cat-lists-pro").html(l)}isActiveTheme(e){return templateberg_all_theme.currentTheme===e.theme.slug}renderItem(s,e,a=!0,t=null){let l="";if(0===t){l="tb-list__item_current";let e=c(".tb-list__item");e.removeClass("tb-list__item_current")}let i="";i=0<s.price?s.price_with_symbol:"Free",e.isActiveTheme(s)&&(l+=" tb-list__active_theme");var r,t='<div aria-label="'+s.title+'" class="tb-list__item '+l+'" data-id="'+s.id+'" data-type="'+s.type+'">',t=(t+='<div class="tb-list__item_preview">')+'<img src="'+s.screenshot_url+'" loading="lazy">';return t+=a?'<span class="tb-list__author"><i class="fas fa-user"></i>'+templateberg_all_theme.text.by+" "+s.author+"</span>":"",t+="</div>",t+='<div class="tb-list__item_footer">',t+='<div class="tb-list__item_price">',t+="<span>",t+=i,t+="</span>",t=(t+="</div>")+'<div class="tb-list__item_meta"><h4><a class="tb-list__item_title_link" href="'+s.permalink+'">'+s.title+"</a></h4>"+((r=s)&&r.theme?e.isActiveTheme(r)?'<span class="tb-list__item-theme"><span class="tb-list__item-theme--link" data-theme_slug="'+r.theme.slug+'"><span class="dashicons dashicons-saved"></span>'+r.theme.name+"</span></span>":'<span class="tb-list__item-theme"><a class="tb-list__item-theme--link" href="'+r.theme.permalink+'" data-theme_slug="'+r.theme.slug+'" target="_blank"><span class="dashicons dashicons-plus-alt2"></span>'+r.theme.name+"</a></span>":"")+"</div>",t=(t+='<div class="tb-list__item_actions">')+'<a class="tb-item__preview_link" href="'+s.demo_url+'" target="_blank">Preview</a>',t+=function(){if(a){var e=s.is_pro?templateberg_all_theme.text.purchase:templateberg_all_theme.text.free,t=s.is_pro?"pro":"free";return'<a type="button" tabindex="0" class="tb-list__item_btn tb-list__item_buy_btn" data-id="'+s.id+'" data-is_pro="'+t+'" href="'+s.permalink+'" data-theme_name="'+s.theme.name+'" data-theme_slug="'+s.theme.slug+'" rel="noopener" target="_blank">'+e+"</a>"}return""}(),t+="</div>",t+="</div>",t+="</div>"}renderTemplates(){c("body").addClass("tb-templates-loading");let t=this,s="";t.state.data[t.state.tab]&&t.state.data[t.state.tab].map(e=>{if(("all-pro"===this.state.selectedCategory&&t.state.countProItems[this.state.tab]||"all-free"===this.state.selectedCategory&&t.state.countFreeItems[this.state.tab]||"all"===this.state.selectedCategory||e.categories&&e.categories.includes(this.state.selectedCategory))&&(!this.state.search||e.keywords&&e.keywords.some(e=>e.toLowerCase().includes(this.state.search.toLowerCase()))||e.title.toLowerCase().includes(this.state.search.toLowerCase()))){if(!this.state.isAllCatSelected&&this.state.isProCatSelected&&!e.is_pro)return"";if(!this.state.isAllCatSelected&&this.state.isFreeCatSelected&&e.is_pro)return"";e=t.renderItem(e,t);s+=e}}),s=s||'<span class="tb-list__content-no-item">No item on selected categories!</span>',c(".tb-list__content").html(s),t.lazyLoading(),setTimeout(function(){c("body").removeClass("tb-templates-loading")},500)}renderTKTemplates(t){let l=this,i=null,s=l.state.data[l.state.tab].find(e=>e.id==t);if(s&&s.templates&&s.templates.length){let a="";s.templates.forEach(function(e,t){var s=l.renderItem(e,l,!1,t);a+=s,0===t&&(i=e.demo_url)});let e=c("#tb-list__item_preview");a='<div class="tb-list__tk_templates">'+a+"</div>",e.find(".tb-list__item_buy_btn").after(a),l.lazyLoading()}return i}lazyLoading(){c(".tb-list__item_preview img").each(function(){c(this).on("load",function(){c(this).parent().addClass("tb-list__img_loaded")}).each(function(){this.complete&&c(this).load()})})}run(){this.templateFetch(),this.mobileMenu();let l=this;c(document).on("click",".tb-list__categories-tab-item",function(e){e.preventDefault();let t=c(this),s=t.attr("data-id"),a=t.closest(".tb-list__categories");if(t.addClass("tb-filter-active"),t.siblings().removeClass("tb-filter-active"),"all"===s){let e=a.find(".tb-cat-lists-all");e.addClass("tb-cats-content-active"),e.siblings().removeClass("tb-cats-content-active"),l.setState({selectedCategory:"all",isAllCatSelected:!0,isFreeCatSelected:!1,isProCatSelected:!1})}else if("free"===s){let e=a.find(".tb-cat-lists-free");e.addClass("tb-cats-content-active"),e.siblings().removeClass("tb-cats-content-active"),l.setState({selectedCategory:"all-free",isAllCatSelected:!1,isFreeCatSelected:!0,isProCatSelected:!1})}else if("pro"===s){let e=a.find(".tb-cat-lists-pro");e.addClass("tb-cats-content-active"),e.siblings().removeClass("tb-cats-content-active"),l.setState({selectedCategory:"all-pro",isAllCatSelected:!1,isFreeCatSelected:!1,isProCatSelected:!0})}l.renderCategories(),l.renderTemplates()}),c(document).on("click",".tb-cat-lists-all li",function(e){e.preventDefault(),l.setState({isAllCatSelected:!0,isFreeCatSelected:!1,isProCatSelected:!1})}),c(document).on("click",".tb-cat-lists-free li",function(e){e.preventDefault(),l.setState({isAllCatSelected:!1,isFreeCatSelected:!0,isProCatSelected:!1})}),c(document).on("click",".tb-cat-lists-pro li",function(e){e.preventDefault(),l.setState({isAllCatSelected:!1,isFreeCatSelected:!1,isProCatSelected:!0})}),c(document).on("click",".tb-list__sidebar a",function(e){e.preventDefault();e=c(this).data("cat");if(e===l.state.selectedCategory)return!1;c(this).parent("li").siblings().removeClass("tb-list__current_item"),c(this).parent("li").addClass("tb-list__current_item"),l.setState({selectedCategory:e}),l.renderTemplates()}),c(document).on("click",".tb-list__cat_btn",function(e){e.preventDefault();e=c(this).data("type");if(e===l.state.tab)return!1;c(this).siblings().removeClass("is-selected"),c(this).addClass("is-selected"),c(".tb-list__searchinput").val(""),l.setState({tab:e,selectedCategory:"all",search:""}),l.renderCategories(),l.renderTemplates()}),c(".tb-list__search i").on("click",function(e){e.preventDefault(),l.setState({search:c(".tb-list__searchinput").val()}),l.renderTemplates()}),c(".tb-list__searchinput").keyup(function(e){13===e.keyCode&&(e.preventDefault(),l.setState({search:c(".tb-list__searchinput").val()}),l.renderTemplates())}),c("#tb-list__sorting_select").on("change",function(e){e.preventDefault(),l.setState({sort:c(this).val()}),l.templateFetch(c(this).val()),l.renderTemplates()}),c(document).on("click",".tb-list__page-link",function(e){e.preventDefault();let t=c(this).data("gpage"),s=c(this).attr("href");c.ajax({type:"GET",url:templateberg_all_theme.restUrl+"connect/v1/get_archive_page",data:{page:t,sort:l.state.sort},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",templateberg_all_theme.restNonce)}}).done(function(e){e&&(l.templateFetch(!1,e.templates),c(".tb-list__navigation").replaceWith(e.pagination),c(".tb-list__links").replaceWith(e.header),l.renderCategories(),c(".tb-list__categories-wrap-tab").children().first().trigger("click"),history.pushState({},null,s))}).fail(function(e,t,s){console.log(e+" :: "+t+" :: "+s)}).always(function(){})}),l.lazyLoading()}}class a{constructor(){this.state={archiveDownload:null}}setState(e){let s=this;c.each(e,function(e,t){s.state[e]=t})}hasPrevItem(){let e=c(".tb-list__item_current");return!!e.prev().length}hasNextItem(){let e=c(".tb-list__item_current");return!!e.next().length}showHidePrevNext(){this.hasNextItem()?c(".tb-preview__next").removeClass("tb-list__page-disabled"):c(".tb-preview__next").addClass("tb-list__page-disabled"),this.hasPrevItem()?c(".tb-preview__prev").removeClass("tb-list__page-disabled"):c(".tb-preview__prev").addClass("tb-list__page-disabled")}hideControls(){c(document).on("click",".tb-preview__collapse-btn",function(e){e.preventDefault(),c(".tb-preview__wrapper").toggleClass("tb-preview__sidebar-hide")})}devicePreview(){c(document).on("click",".tb-preview__desktop",function(e){e.preventDefault(),c(".tb-preview__wrapper").removeClass("tb-preview-t tb-preview-m"),c(this).addClass("active").siblings().removeClass("active")}),c(document).on("click",".tb-preview__tablet",function(e){e.preventDefault(),c(".tb-preview__wrapper").removeClass("tb-preview-t tb-preview-m").addClass("tb-preview-t"),c(this).addClass("active").siblings().removeClass("active")}),c(document).on("click",".tb-preview__mobile",function(e){e.preventDefault(),c(".tb-preview__wrapper").removeClass("tb-preview-t tb-preview-m").addClass("tb-preview-m"),c(this).addClass("active").siblings().removeClass("active")})}hidePreview(){c(document).on("click",".tb-preview__close",function(e){e.preventDefault(),c("body").removeClass("tb-preview"),c("#tb-list__item_preview").hide(),c(".tb-list__tk_templates").remove()})}renderPreview(){let e=c(".tb-list__item_current"),t=e.data("id"),s=e.find("img").attr("src"),a=e.find("h4").text(),l=e.find(".tb-list__item_title_link").attr("href"),i=e.find(".tb-list__author").html(),r=e.find(".tb-item__preview_link").attr("href"),n=c("#tb-list__item_preview");var o;n.addClass("tb-item__preview_loading"),n.find(".tb-list__item_buy_btn").remove(),n.find(".tb-list__item").remove(),n.find("h4").text(a),n.find("img").attr("src",s),n.find(".tb-list__item_title_link").attr("href",l),n.find(".tb-preview__author").html(i),e.find(".tb-list__item_buy_btn").clone().insertAfter(n.find(".tb-preview__author")),c("body").addClass("tb-preview"),document.getElementById("tb-preview__frame").src=r,this.state.archiveDownload&&t&&((o=this.state.archiveDownload.renderTKTemplates(t))&&(document.getElementById("tb-preview__frame").src=o)),n.show(),this.showHidePrevNext(),setTimeout(function(){n.removeClass("tb-item__preview_loading")},3e3)}replacePreview(){let e=c(".tb-list__item_current"),t=e.find(".tb-item__preview_link").attr("href"),s=c("#tb-list__item_preview");s.addClass("tb-item__preview_loading"),document.getElementById("tb-preview__frame").src=t,this.showHidePrevNext(),setTimeout(function(){s.removeClass("tb-item__preview_loading")},3e3)}run(e=null){e.run();let l=this;l.setState({archiveDownload:e}),c(document).on("click",".tb-item__preview_link",function(e){e.preventDefault();let t=c(this).closest(".tb-list__item");t.siblings().removeClass("tb-list__item_current"),t.addClass("tb-list__item_current"),t.parent().hasClass("tb-list__tk_templates")?l.replacePreview():l.renderPreview()}),c(document).on("click",".tb-preview__prev",function(e){e.preventDefault();let t=c(".tb-list__item_current"),s=c(".tb-list__item");if(!t.prev().length)return!1;let a=t.prev();s.removeClass("tb-list__item_current"),a.addClass("tb-list__item_current"),0<c(".tb-preview__sidebar-content").children(".tb-list__tk_templates").length?l.replacePreview():l.renderPreview()}),c(document).on("click",".tb-preview__next",function(e){e.preventDefault();let t=c(".tb-list__item_current"),s=c(".tb-list__item");if(!t.next().length)return!1;let a=t.next();s.removeClass("tb-list__item_current"),a.addClass("tb-list__item_current"),0<c(".tb-preview__sidebar-content").children(".tb-list__tk_templates").length?l.replacePreview():l.renderPreview()}),l.hideControls(),l.devicePreview(),l.hidePreview()}}class l{constructor(){this.state={archiveDownload:null}}setState(e){let s=this;c.each(e,function(e,t){s.state[e]=t})}buyPopup(e){c.ajax({type:"GET",url:"https://templateberg.com/wp-json/connect/v1/get_cart",data:{id:e}}).done(function(e){e&&(c("#tb-list__popup_loader").hide(),c("#tb-list__item_buy_popup").html(e))}).fail(function(e,t,s){console.log(e+" :: "+t+" :: "+s)}).always(function(){})}run(){c(document).on("click",".tb-list__item_buy_btn",function(e){let t=c(this),s=c(this).data("is_pro");if("pro"===s)return!0;e.preventDefault(),c("body").addClass("tb-template-popup"),c("body").addClass("tb-template-popup-loading"),c(".tb-modal__theme_install_link").text(t.attr("data-theme_name")),c(".tb-modal__theme_install_link").attr("href",c(".tb-modal__theme_install_link").attr("href")+t.attr("data-theme_slug")),c("#tb-list__popup_loader").show(),setTimeout(function(){c("#tb-list__item_free_popup").show(),c("#tb-list__popup_loader").hide(),c("body").removeClass("tb-template-popup-loading")},300)}),c(document).on("click",".tb-modal__cancel",function(e){e.preventDefault(),c("body").addClass("tb-template-popup-loading"),c("body").removeClass("tb-template-popup"),c("#tb-list__popup_loader").hide(),c("#tb-list__item_buy_popup").html("").hide(),c("#tb-list__item_free_popup").hide(),setTimeout(function(){c("body").removeClass("tb-template-popup-loading")},3e3)}),c(document).on("click",".tb-list__item-theme>a",function(e){e.preventDefault();var t=c(this).text(),e=c(this).data("theme_slug");s("type","selected"),s("theme",t),s("slug",e),location.reload()})}}c(document).ready(function(){var e=new t;(new a).run(e),(new l).run()})}(jQuery);